project_name: "auto-dev-llm-self-improvement"
description: "ØªÙˆØ³Ø¹Ù‡ Ø®ÙˆØ¯ Ø³ÛŒØ³ØªÙ… Auto-Dev-LLM Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø®ÙˆØ¯Ø´"
version: "0.2.0"

# ØªÙ†Ø¸ÛŒÙ…Ø§Øª LLM
llm:
  mode: "online" # Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² API Ø³ÙØ§Ø±Ø´ÛŒ

  # ØªÙ†Ø¸ÛŒÙ…Ø§Øª API Ø³ÙØ§Ø±Ø´ÛŒ
  custom_api:
    enabled: true
    base_url: "https://api.avalai.ir/v1" # ğŸ”§ Ø¢Ø¯Ø±Ø³ Ø³Ø±ÙˆØ± Ø´Ù…Ø§
    api_key_env: "CUSTOM_API_KEY" # Ù†Ø§Ù… Ù…ØªØºÛŒØ± Ù…Ø­ÛŒØ·ÛŒ
    model: "claude-sonnet-4-20250514" # Sonnet 4.5

    # Headers Ø³ÙØ§Ø±Ø´ÛŒ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)
    custom_headers:
      "X-Custom-Header": "your-value"

    # Endpoint paths (Ø§Ø®ØªÛŒØ§Ø±ÛŒ - Ø§Ú¯Ø± Ù…ØªÙØ§ÙˆØª Ø¨Ø§Ø´Ø¯)
    endpoints:
      chat: "/chat/completions" # Ø¨Ø±Ø§ÛŒ OpenAI-compatible
      # ÛŒØ§: "/messages" Ø¨Ø±Ø§ÛŒ Anthropic-compatible

  # ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ø¨Ø±Ø§ÛŒ fallback
  online:
    provider: "custom" # Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² custom API
    api_key_env: "CUSTOM_API_KEY"
    model: "claude-sonnet-4-20250514"

    # ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¯Ø±Ø®ÙˆØ§Ø³Øª
    timeout: 300
    retry: 3
    max_tokens: 4096
    temperature: 0.7

    # Prompt caching Ø¨Ø±Ø§ÛŒ Ú©Ø§Ù‡Ø´ Ù‡Ø²ÛŒÙ†Ù‡
    use_cache: true

  # MCP Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† fallback Ø«Ø§Ù†ÙˆÛŒÙ‡
  mcp:
    api_url: "http://localhost:5005"
    timeout: 300
    retry: 2

  # Ø§ÙˆÙ„ÙˆÛŒØª Ø§Ø³ØªÙØ§Ø¯Ù‡
  fallback_online: false # ÙÙ‚Ø· Ø§Ø² custom API Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†
  fallback_to_mcp: false # Ø¯Ø± ØµÙˆØ±Øª Ø®Ø·Ø§ Ø¨Ù‡ MCP Ù†Ø±Ùˆ

# ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù‡Ø²ÛŒÙ†Ù‡ Ùˆ Ù…Ø­Ø¯ÙˆØ¯ÛŒØª
cost_control:
  enabled: true
  max_cost_per_task: 0.10 # Ø¯Ù„Ø§Ø±
  max_total_cost: 2.00 # Ø¯Ù„Ø§Ø±
  warn_threshold: 0.50 # Ù‡Ø´Ø¯Ø§Ø± Ø¯Ø± 50 Ø³Ù†Øª

  # Token limits
  max_input_tokens: 2000
  max_output_tokens: 3000

# ØªÙ†Ø¸ÛŒÙ…Ø§Øª Scheduler
scheduler:
  active_hours:
    start: 0 # 24/7 Ø¨Ø±Ø§ÛŒ ØªÙˆØ³Ø¹Ù‡ Ø³Ø±ÛŒØ¹
    end: 24
  max_concurrent_tasks: 3 # Ø§ÙØ²Ø§ÛŒØ´ Ù‡Ù…Ø²Ù…Ø§Ù†ÛŒ
  check_interval: 30
  cpu_threshold: 85

# ØªÙ†Ø¸ÛŒÙ…Ø§Øª Git
git:
  auto_commit: true
  commit_message_template: "ğŸ¤– Auto-generated: {task_name} - {feature_name}"
  branch_pattern: "auto-dev/phase-2/{feature_name}"
  auto_push: false

# ØªÙ†Ø¸ÛŒÙ…Ø§Øª Versioning
versioning:
  semantic_versioning: true
  auto_bump: true
  version_file: "VERSION"
  rules:
    major: ["breaking", "major"]
    minor: ["feature", "feat", "add"]
    patch: ["fix", "patch", "refactor", "improve"]

# ØªÙ†Ø¸ÛŒÙ…Ø§Øª Logging
logging:
  log_path: "./logs"
  level: "DEBUG"
  per_feature_log: true
  rotation: "1 day"
  retention: "7 days"

# ØªÙ†Ø¸ÛŒÙ…Ø§Øª Rollback
rollback:
  enabled: true
  backup_path: "./backups"
  max_backups: 20
  auto_rollback_on_error: true

# ØªÙ†Ø¸ÛŒÙ…Ø§Øª Deploy
deploy:
  enabled: false # ØºÛŒØ±ÙØ¹Ø§Ù„ Ø¨Ø±Ø§ÛŒ ØªÙˆØ³Ø¹Ù‡ Ù…Ø­Ù„ÛŒ
  type: "canary"

# Features Ø¨Ø±Ø§ÛŒ ØªÙˆØ³Ø¹Ù‡ ÙØ§Ø² 2
features:
  # Ø§ÙˆÙ„ÙˆÛŒØª 1: Git Utilities
  - name: "git-automation"
    priority: 1
    description: "Ø®ÙˆØ¯Ú©Ø§Ø±Ø³Ø§Ø²ÛŒ Ú©Ø§Ù…Ù„ Ø¹Ù…Ù„ÛŒØ§Øª Git"
    tasks:
      - name: "git-wrapper"
        description: |
          Ø§ÛŒØ¬Ø§Ø¯ GitWrapper class Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ:
          - Initialize repository
          - Stage files (add)
          - Commit Ø¨Ø§ message template
          - Create branches
          - Checkout branches
          - Merge branches
          - Push to remote
          - Pull from remote
          - Get commit history
          - Diff between commits
          - Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² GitPython
        files:
          - "src/utils/git_utils.py"
        tests:
          - "tests/test_git_utils.py"

      - name: "commit-manager"
        description: |
          CommitManager Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ù‡ÙˆØ´Ù…Ù†Ø¯ commit Ù‡Ø§:
          - Auto-stage generated files
          - Generate commit message Ø§Ø² task info
          - Group related changes
          - Commit hooks
          - Pre-commit validation
        files:
          - "src/managers/commit_manager.py"
        tests:
          - "tests/test_commit_manager.py"

  # Ø§ÙˆÙ„ÙˆÛŒØª 2: Version Management
  - name: "version-control"
    priority: 2
    description: "Ù…Ø¯ÛŒØ±ÛŒØª Ù†Ø³Ø®Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Semantic"
    tasks:
      - name: "version-manager"
        description: |
          VersionManager Ø¨Ø±Ø§ÛŒ Semantic Versioning:
          - Ø®ÙˆØ§Ù†Ø¯Ù† VERSION file ÛŒØ§ pyproject.toml
          - ØªØ´Ø®ÛŒØµ Ù†ÙˆØ¹ ØªØºÛŒÛŒØ± (major/minor/patch)
          - Auto-bump version
          - Git tagging
          - Changelog generation
          - Version validation
          - Rollback version
        files:
          - "src/managers/version_manager.py"
        tests:
          - "tests/test_version_manager.py"

      - name: "changelog-generator"
        description: |
          ChangelogGenerator Ø¨Ø±Ø§ÛŒ Ø³Ø§Ø®Øª CHANGELOG.md:
          - Parse commit messages
          - Group by type (feat, fix, breaking)
          - Generate markdown
          - Update CHANGELOG.md
          - Link to commits/PRs
        files:
          - "src/utils/changelog.py"
        tests:
          - "tests/test_changelog.py"

  # Ø§ÙˆÙ„ÙˆÛŒØª 3: Rollback System
  - name: "rollback-recovery"
    priority: 3
    description: "Ø³ÛŒØ³ØªÙ… Ø¨Ø§Ø²Ú¯Ø´Øª Ùˆ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ"
    tasks:
      - name: "backup-manager"
        description: |
          BackupManager Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ù†Ø³Ø®Ù‡â€ŒÙ‡Ø§ÛŒ Ù¾Ø´ØªÛŒØ¨Ø§Ù†:
          - Create backup Ù‚Ø¨Ù„ Ø§Ø² Ù‡Ø± task
          - Compress backups (tar.gz)
          - Manage backup retention
          - List available backups
          - Restore from backup
          - Clean old backups
        files:
          - "src/managers/backup_manager.py"
        tests:
          - "tests/test_backup_manager.py"

      - name: "rollback-manager"
        description: |
          RollbackManager Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø²Ú¯Ø´Øª Ø®ÙˆØ¯Ú©Ø§Ø±:
          - Detect failures (exceptions, test fails)
          - Auto-restore Ø§Ø² backup
          - Git reset/revert
          - Notify user
          - Log rollback operations
          - Manual rollback command
        files:
          - "src/managers/rollback_manager.py"
        tests:
          - "tests/test_rollback_manager.py"

  # Ø§ÙˆÙ„ÙˆÛŒØª 4: Deploy System
  - name: "deploy-automation"
    priority: 4
    description: "Ø³ÛŒØ³ØªÙ… Ø§Ø³ØªÙ‚Ø±Ø§Ø± Ø®ÙˆØ¯Ú©Ø§Ø±"
    tasks:
      - name: "deploy-strategy"
        description: |
          DeployStrategy base class Ùˆ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Canary:
          - Abstract DeployStrategy class
          - CanaryDeployStrategy (10% -> 50% -> 100%)
          - BlueGreenDeployStrategy
          - RollingDeployStrategy
          - Health check integration
          - Rollback on failure
        files:
          - "src/managers/deploy_strategy.py"
        tests:
          - "tests/test_deploy_strategy.py"

      - name: "deploy-manager"
        description: |
          DeployManager Ø§ØµÙ„ÛŒ:
          - Execute deploy strategy
          - Monitor health checks
          - Control traffic splitting
          - Auto-rollback on failure
          - Deploy notifications
          - Deploy history
        files:
          - "src/managers/deploy_manager.py"
        tests:
          - "tests/test_deploy_manager.py"

      - name: "health-checker"
        description: |
          HealthChecker Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ø±Ø³ÛŒ Ø³Ù„Ø§Ù…Øª:
          - HTTP endpoint checks
          - Response time monitoring
          - Status code validation
          - Custom health validators
          - Retry mechanism
          - Alert on failure
        files:
          - "src/utils/health_checker.py"
        tests:
          - "tests/test_health_checker.py"

  # Ø§ÙˆÙ„ÙˆÛŒØª 5: Prompt Engineering
  - name: "prompt-system"
    priority: 5
    description: "Ø³ÛŒØ³ØªÙ… Ù¾ÛŒØ´Ø±ÙØªÙ‡ Prompt Engineering"
    tasks:
      - name: "prompt-templates"
        description: |
          PromptTemplate system Ø¨Ø±Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ú©Ø¯ Ø¨Ù‡ØªØ±:
          - Base PromptTemplate class
          - CodeGenerationPrompt
          - TestGenerationPrompt
          - RefactoringPrompt
          - DocumentationPrompt
          - Template variables
          - Context injection
        files:
          - "src/llm/prompt_templates.py"
        tests:
          - "tests/test_prompt_templates.py"

      - name: "prompt-optimizer"
        description: |
          PromptOptimizer Ø¨Ø±Ø§ÛŒ Ø¨Ù‡Ø¨ÙˆØ¯ Ø®ÙˆØ¯Ú©Ø§Ø±:
          - Analyze LLM responses
          - Track success rates
          - A/B testing prompts
          - Auto-tune parameters
          - Save best prompts
          - Prompt versioning
        files:
          - "src/llm/prompt_optimizer.py"
        tests:
          - "tests/test_prompt_optimizer.py"

      - name: "context-builder"
        description: |
          ContextBuilder Ø¨Ø±Ø§ÛŒ Ø³Ø§Ø®Øª context Ø¨Ù‡ØªØ±:
          - Extract relevant files
          - Parse dependencies
          - Include related code
          - Add docstrings
          - Format for LLM
          - Context size management
        files:
          - "src/llm/context_builder.py"
        tests:
          - "tests/test_context_builder.py"

  # Ø§ÙˆÙ„ÙˆÛŒØª 6: Testing & Quality
  - name: "quality-assurance"
    priority: 6
    description: "Ø³ÛŒØ³ØªÙ… ØªØ³Øª Ùˆ Ú©ÛŒÙÛŒØª Ø®ÙˆØ¯Ú©Ø§Ø±"
    tasks:
      - name: "test-runner"
        description: |
          TestRunner Ø¨Ø±Ø§ÛŒ Ø§Ø¬Ø±Ø§ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± ØªØ³Øªâ€ŒÙ‡Ø§:
          - Run pytest tests
          - Parse test results
          - Coverage analysis
          - Performance benchmarks
          - Retry failed tests
          - Generate reports
        files:
          - "src/utils/test_runner.py"
        tests:
          - "tests/test_test_runner.py"

      - name: "code-analyzer"
        description: |
          CodeAnalyzer Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ø±Ø³ÛŒ Ú©ÛŒÙÛŒØª:
          - Syntax checking (ast)
          - Style checking (flake8, black)
          - Type checking (mypy)
          - Complexity analysis
          - Security scanning
          - Generate fix suggestions
        files:
          - "src/utils/code_analyzer.py"
        tests:
          - "tests/test_code_analyzer.py"

      - name: "quality-gate"
        description: |
          QualityGate Ø¨Ø±Ø§ÛŒ ØªØ§ÛŒÛŒØ¯ Ú©ÛŒÙÛŒØª:
          - Define quality thresholds
          - Check test coverage
          - Check code style
          - Check complexity
          - Block on failures
          - Generate quality reports
        files:
          - "src/utils/quality_gate.py"
        tests:
          - "tests/test_quality_gate.py"

  # Ø§ÙˆÙ„ÙˆÛŒØª 7: File Management
  - name: "file-operations"
    priority: 7
    description: "Ù…Ø¯ÛŒØ±ÛŒØª Ù¾ÛŒØ´Ø±ÙØªÙ‡ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§"
    tasks:
      - name: "file-utils"
        description: |
          FileUtils Ø¨Ø±Ø§ÛŒ Ø¹Ù…Ù„ÛŒØ§Øª ÙØ§ÛŒÙ„:
          - Safe file write (atomic)
          - Backup before modify
          - Template rendering
          - File comparison
          - Directory operations
          - Path validation
        files:
          - "src/utils/file_utils.py"
        tests:
          - "tests/test_file_utils.py"

      - name: "project-structure"
        description: |
          ProjectStructureManager:
          - Analyze project structure
          - Validate paths
          - Create directories
          - Organize files
          - Detect file types
          - Generate tree view
        files:
          - "src/utils/project_structure.py"
        tests:
          - "tests/test_project_structure.py"

  # Ø§ÙˆÙ„ÙˆÛŒØª 8: Orchestrator Enhancement
  - name: "orchestrator-v2"
    priority: 8
    description: "Ø¨Ù‡Ø¨ÙˆØ¯ Orchestrator Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯"
    tasks:
      - name: "enhanced-orchestrator"
        description: |
          Ø¨Ù‡Ø¨ÙˆØ¯ Orchestrator ÙØ¹Ù„ÛŒ Ø¨Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù†:
          - Integration Ø¨Ø§ ØªÙ…Ø§Ù… managers Ø¬Ø¯ÛŒØ¯
          - Auto-commit after each task
          - Auto-version bump
          - Auto-backup before tasks
          - Quality gate enforcement
          - Better error handling
          - Resume from checkpoint
          - Parallel task execution
        files:
          - "src/core/orchestrator_v2.py"
        tests:
          - "tests/test_orchestrator_v2.py"
